{"version":3,"file":"__output.js","sources":["test-flow.spec.ts"],"sourcesContent":["import { retry } from '@snoka/runner/src/global/test-flow'\n\ndescribe('peeky.retry()', () => {\n  test('must not retry when no error', async () => {\n    const spy = sinon.fake()\n    expect(spy.callCount).to.eql(0)\n    await retry(() => spy(), 10)\n    expect(spy.callCount).to.eql(1)\n  })\n\n  test('retry multiple times', async () => {\n    let times = 0\n    const spy = sinon.fake(() => {\n      times++\n      if (times < 4) {\n        throw new Error('Not enough times')\n      }\n    })\n    expect(spy.callCount).to.eql(0)\n    await retry(() => spy(), 5)\n    expect(spy.callCount).to.eql(4)\n  })\n\n  test('retry multiple times and bail out', async () => {\n    const spy = sinon.fake(() => {\n      throw new Error('Not enough times')\n    })\n    expect(spy.callCount).to.eql(0)\n    let error: Error\n    try {\n      await retry(() => spy(), 5)\n    } catch (e) {\n      error = e\n    }\n    expect(spy.callCount).to.eql(5)\n    expect(error).not.to.be.undefined()\n  })\n})\n"],"names":["retry"],"mappings":";;;;AAEA,QAAA,CAAS,iBAAiB,MAAM;AAC9B,EAAA,IAAA,CAAK,gCAAgC,YAAY;AAC/C,IAAM,MAAA,GAAA,GAAM,MAAM,IAAK,EAAA,CAAA;AACvB,IAAA,MAAA,CAAO,GAAI,CAAA,SAAS,CAAE,CAAA,EAAA,CAAG,IAAI,CAAC,CAAA,CAAA;AAC9B,IAAA,MAAMA,cAAM,CAAA,MAAM,GAAI,EAAA,EAAG,EAAE,CAAA,CAAA;AAC3B,IAAA,MAAA,CAAO,GAAI,CAAA,SAAS,CAAE,CAAA,EAAA,CAAG,IAAI,CAAC,CAAA,CAAA;AAAA,GAC/B,CAAA,CAAA;AAED,EAAA,IAAA,CAAK,wBAAwB,YAAY;AACvC,IAAA,IAAI,KAAQ,GAAA,CAAA,CAAA;AACZ,IAAM,MAAA,GAAA,GAAM,KAAM,CAAA,IAAA,CAAK,MAAM;AAC3B,MAAA,KAAA,EAAA,CAAA;AACA,MAAA,IAAI,QAAQ,CAAG,EAAA;AACb,QAAM,MAAA,IAAI,MAAM,kBAAkB,CAAA,CAAA;AAAA,OACpC;AAAA,KACD,CAAA,CAAA;AACD,IAAA,MAAA,CAAO,GAAI,CAAA,SAAS,CAAE,CAAA,EAAA,CAAG,IAAI,CAAC,CAAA,CAAA;AAC9B,IAAA,MAAMA,cAAM,CAAA,MAAM,GAAI,EAAA,EAAG,CAAC,CAAA,CAAA;AAC1B,IAAA,MAAA,CAAO,GAAI,CAAA,SAAS,CAAE,CAAA,EAAA,CAAG,IAAI,CAAC,CAAA,CAAA;AAAA,GAC/B,CAAA,CAAA;AAED,EAAA,IAAA,CAAK,qCAAqC,YAAY;AACpD,IAAM,MAAA,GAAA,GAAM,KAAM,CAAA,IAAA,CAAK,MAAM;AAC3B,MAAM,MAAA,IAAI,MAAM,kBAAkB,CAAA,CAAA;AAAA,KACnC,CAAA,CAAA;AACD,IAAA,MAAA,CAAO,GAAI,CAAA,SAAS,CAAE,CAAA,EAAA,CAAG,IAAI,CAAC,CAAA,CAAA;AAC9B,IAAI,IAAA,KAAA,CAAA;AACJ,IAAI,IAAA;AACF,MAAA,MAAMA,cAAM,CAAA,MAAM,GAAI,EAAA,EAAG,CAAC,CAAA,CAAA;AAAA,aACnB,CAAP,EAAA;AACA,MAAQ,KAAA,GAAA,CAAA,CAAA;AAAA,KACV;AACA,IAAA,MAAA,CAAO,GAAI,CAAA,SAAS,CAAE,CAAA,EAAA,CAAG,IAAI,CAAC,CAAA,CAAA;AAC9B,IAAA,MAAA,CAAO,KAAK,CAAA,CAAE,GAAI,CAAA,EAAA,CAAG,GAAG,SAAU,EAAA,CAAA;AAAA,GACnC,CAAA,CAAA;AACH,CAAC,CAAA;;"}